---
interface Props {
    heading?: string;
    title?: string;
    paragraph?: string;
    location?: string;
    form?: { name: string; email: string; message: string; submit: string; success: string; error: string };
}
const { heading = "Let's talk", title = "Contact", paragraph = "Have a question or a project in mind? Feel free to reach out.", location = "Location:", form = { name: "Name", email: "Email", message: "Message", submit: "Submit", success: "âœ… Thank you for your message!", error: "There was a problem sending your message." } } = Astro.props as Props;
---

<section id="contact" class="w-full py-12 border-t border-[#ffffff10]">
    <div class="max-w-5xl mx-auto">
        <h2 class="text-lg text-[var(--sec)] mb-2 shiny-sec">{heading}</h2>
        <h3 class="text-4xl md:text-5xl font-medium text-[var(--white)] mb-6">{title}</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="text-[var(--white-icon)]">
                <p class="mb-4">{paragraph}</p>
                <div class="flex items-center gap-2">
                    <span>{location}</span>
                    <span class="text-[var(--white)]">Ecuador, Guayaquil</span>
                </div>
            </div>

            <div>
                <form id="contact-form" action="https://formspree.io/f/mnnjznkj" method="POST" class="flex flex-col gap-4">
                    <input type="text" name="from_name" placeholder={form.name} required class="px-4 py-2 bg-[#1414149c] text-[var(--white)] border border-[var(--white-icon-tr)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--sec)]" />
                    <input type="email" name="reply_to" placeholder={form.email} required class="px-4 py-2 bg-[#1414149c] text-[var(--white)] border border-[var(--white-icon-tr)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--sec)]" />
                    <textarea name="message" placeholder={form.message} rows="6" required class="px-4 py-2 bg-[#1414149c] text-[var(--white)] border border-[var(--white-icon-tr)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--sec)] resize-none"></textarea>
                    <button type="submit" class="px-4 py-2 bg-[var(--white-icon-tr)] text-[var(--white)] rounded-lg opacity-60 transition-opacity border border-[var(--white-icon-tr)] hover:opacity-100 hover:bg-[var(--white-icon-tr)]">
                        {form.submit}
                    </button>
                </form>
                <div id="form-message" class="hidden justify-center items-center mt-4 text-[var(--white)] text-lg">
                    {form.success}
                </div>
            </div>
        </div>
    </div>
</section>

<script type="module" is:inline>
    const form = document.getElementById("contact-form");
    const formMessage = document.getElementById("form-message");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = new FormData(form);

        try {
            const response = await fetch(form.action, {
                method: "POST",
                body: formData,
                headers: { Accept: "application/json" },
            });
            if (response.ok) {
                form.reset();
                form.style.display = "none";
                formMessage.classList.remove("hidden");
            } else {
                const data = await response.json();
                console.error("Error response:", data);
                alert(form.error);
            }
        } catch (error) {
            console.error("Error:", error);
            alert(form.error);
        }
    });
</script>
